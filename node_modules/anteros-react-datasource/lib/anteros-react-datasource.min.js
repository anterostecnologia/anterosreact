!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("anteros-react-core"),require("axios"),require("lodash"),require("react")):"function"==typeof define&&define.amd?define("anteros-react-datasource",["anteros-react-core","axios","lodash","react"],e):"object"==typeof exports?exports["anteros-react-datasource"]=e(require("anteros-react-core"),require("axios"),require("lodash"),require("react")):t["anteros-react-datasource"]=e(t["anteros-react-core"],t.axios,t.lodash,t.react)}(this,function(t,e,r,s){return function(t){function e(s){if(r[s])return r[s].exports;var i=r[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};return e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,s){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:s})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e,r){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.AnterosRemoteDatasource=e.AnterosLocalDatasource=e.dataSourceEvents=void 0;var n=function t(e,r,s){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,r);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,r,s)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(s)},h=function(){function t(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,r,s){return r&&t(e.prototype,r),s&&t(e,s),e}}(),d=r(2),c=r(3),u=s(c),l=r(4),f=r(5),R=s(f),E=e.dataSourceEvents={BEFORE_OPEN:"beforeOpen",AFTER_OPEN:"afterOpen",BEFORE_CLOSE:"beforeClose",AFTER_CLOSE:"afterClose",BEFORE_GOTO_PAGE:"beforeGoToPage",AFTER_GOTO_PAGE:"afterGoToPage",AFTER_SCROLL:"afterScroll",BEFORE_EDIT:"beforeEdit",BEFORE_DELETE:"befeoreDelete",AFTER_EDIT:"afterEdit",AFTER_DELETE:"afterDelete",BEFORE_POST:"beforePost",AFTER_POST:"afterPost",BEFORE_CANCEL:"beforeCancel",AFTER_CANCEL:"afterCancel",BEFORE_INSERT:"beforeInsert",AFTER_INSERT:"afterInsert",BEFORE_VALIDATE:"beforeValidate",AFTER_VALIDATE:"afterValidate",DATA_FIELD_CHANGED:"dataFieldChanged",ON_ERROR:"onError"},p=function(){function t(){a(this,t),this.open=this.open.bind(this),this.close=this.close.bind(this),this.addEventListener=this.addEventListener.bind(this),this.removeEventListener=this.removeEventListener.bind(this),this.dispatchEvent=this.dispatchEvent.bind(this),this.getData=this.getData.bind(this),this.getTotalPages=this.getTotalPages.bind(this),this.getCurrentPage=this.getCurrentPage.bind(this),this.getTotalRecords=this.getTotalRecords.bind(this),this.getGrandTotalRecords=this.getGrandTotalRecords.bind(this),this.getSizeOfPage=this.getSizeOfPage.bind(this),this.goToPage=this.goToPage.bind(this),this.isEmpty=this.isEmpty.bind(this),this.isEOF=this.isEOF.bind(this),this.isBOF=this.isBOF.bind(this),this.getCurrentRecord=this.getCurrentRecord.bind(this),this.getState=this.getState.bind(this),this.getPrimaryKeyFields=this.getPrimaryKeyFields.bind(this),this.getPrimaryKey=this.getPrimaryKey.bind(this),this.getRecno=this.getRecno.bind(this),this.gotoRecordByPrimaryKey=this.gotoRecordByPrimaryKey.bind(this),this.gotoRecord=this.gotoRecord.bind(this),this.gotoRecordByData=this.gotoRecordByData.bind(this),this.isFirst=this.isFirst.bind(this),this.isLast=this.isLast.bind(this),this.first=this.first.bind(this),this.last=this.last.bind(this),this.next=this.next.bind(this),this.prior=this.prior.bind(this),this.previous=this.previous.bind(this),this.hasNext=this.hasNext.bind(this),this.hasPrior=this.hasPrior.bind(this),this.hasPrevious=this.hasPrevious.bind(this),this.insert=this.insert.bind(this),this.edit=this.edit.bind(this),this.delete=this.delete.bind(this),this.post=this.post.bind(this),this.cancel=this.cancel.bind(this),this.isOpen=this.isOpen.bind(this),this._validateDelete=this._validateDelete.bind(this),this._validateInsert=this._validateInsert.bind(this),this._validateEdit=this._validateEdit.bind(this),this._validateCancel=this._validateCancel.bind(this),this._validatePost=this._validatePost.bind(this),this.disabledAllListeners=this.disabledAllListeners.bind(this),this.enableAllListeners=this.enableAllListeners.bind(this),this.data=[],this.listeners=[],this.totalPages=0,this.currentPage=0,this.totalRecords=0,this.grandTotalRecords=0,this.sizeOfPage=0,this.dsState="dsBrowse",this.currentRecord=null,this.currentRecno=-1,this.primaryKeyFields=[],this.oldRecordInsert=null,this.oldRecnoInsert=null,this.active=!1,this.getTotalPages=this.getTotalPages.bind(this),this.contentProperty="content",this.totalPagesProperty="totalPages",this.currentPageProperty="number",this.totalRecordsProperty="numberOfElements",this.sizeOfPageProperty="size",this.grandTotalRecordsProperty="totalElements",this.setContentProperty=this.setContentProperty.bind(this),this.setTotalPagesProperty=this.setTotalPagesProperty.bind(this),this.setCurrentPageProperty=this.setCurrentPageProperty.bind(this),this.setTotalRecordsProperty=this.setTotalRecordsProperty.bind(this),this.setSizeOfPageProperty=this.setSizeOfPageProperty.bind(this),this.setGrandTotalRecordsProperty=this.setGrandTotalRecordsProperty.bind(this),this.fieldByName=this.fieldByName.bind(this),this.setFieldByName=this.setFieldByName.bind(this),this._enableListeners=!0}return h(t,[{key:"setContentProperty",value:function(t){this.contentProperty=t}},{key:"setTotalPagesProperty",value:function(t){this.totalPagesProperty=t}},{key:"setCurrentPageProperty",value:function(t){this.currentPageProperty=t}},{key:"setTotalRecordsProperty",value:function(t){this.totalRecordsProperty=t}},{key:"setSizeOfPageProperty",value:function(t){this.sizeOfPageProperty=t}},{key:"setGrandTotalRecordsProperty",value:function(t){this.setGrandTotalRecordsProperty=t}},{key:"open",value:function(){this.close(),this.data=[],this.active=!0,this.dispatchEvent(E.BEFORE_OPEN)}},{key:"isOpen",value:function(){return this.active}},{key:"close",value:function(){this.active&&(this.active=!1,this.dispatchEvent(E.BEFORE_CLOSE))}},{key:"getData",value:function(){return this.data}},{key:"getTotalPages",value:function(){return this.totalPages}},{key:"getCurrentPage",value:function(){return this.currentPage}},{key:"getTotalRecords",value:function(){return this.totalRecords}},{key:"getSizeOfPage",value:function(){return this.sizeOfPage}},{key:"goToPage",value:function(t){this.currentPage=t}},{key:"getGrandTotalRecords",value:function(){return this.grandTotalRecords}},{key:"isEmpty",value:function(){return 0==this.getTotalRecords()}},{key:"getCurrentRecord",value:function(){return this.currentRecord}},{key:"getPrimaryKeyFields",value:function(){return this.primaryKeyFields}},{key:"getState",value:function(){return this.dsState}},{key:"getRecno",value:function(){return this.currentRecno}},{key:"gotoRecordByPrimaryKey",value:function(t){if("dsBrowse"!=this.getState())throw new d.AnterosDatasourceError("Registro atual está sendo inserido ou editado.");if(!t)throw new d.AnterosDatasourceError("Informe os valores da chave primária para ir para um registro.");if(R.default.Children.toArray(t).length!=getPrimaryKeyFields().length)throw new d.AnterosDatasourceError("Número de valores da chave primária incorretos.");if(!this.primaryKeyFields||0==this.primaryKeyFields.length)throw new d.AnterosDatasourceError("Campos da chave primária do Datasource não foram definidas.");if(this.data){var e=this;this.data.forEach(function(t){var r=t,s=e.getPrimaryKeyFields(),i=0;if(this.arrValues.forEach(function(t,e){r[s[e]]==t&&i++}),i==s.length)return t})}}},{key:"getPrimaryKey",value:function(){var t=[];this.isEmpty()||this.primaryKeyFields.forEach(function(e,r){t.push({field:this.currentRecord[e]})})}},{key:"gotoRecord",value:function(t){if("dsBrowse"!=this.getState())throw new d.AnterosDatasourceError("Registro atual está sendo inserido ou editado.");if(void 0==t||t<0)throw new d.AnterosDatasourceError("Número do registro informado inválido "+t);if(this.isEmpty())throw new d.AnterosDatasourceError("Não há registros para posicionar.");if(t>this.getTotalRecords()-1)throw new d.AnterosDatasourceError("Número do registro maior que o total de registros.");this.currentRecno=t,this.currentRecord=this.data[t],this.dispatchEvent(E.AFTER_SCROLL)}},{key:"gotoRecordByData",value:function(t){var e=this;if("dsBrowse"!=this.getState())throw new d.AnterosDatasourceError("Registro atual está sendo inserido ou editado.");if(this.isEmpty())throw new d.AnterosDatasourceError("Não há registros para posicionar.");this.currentRecord!=t&&this.data.forEach(function(r,s){if(t==r)return e.currentRecno=s,e.currentRecord=r,void e.dispatchEvent(E.AFTER_SCROLL)})}},{key:"fieldByName",value:function(t){if(!t)throw new d.AnterosDatasourceError("Nome do campo inválido.");if(!this.isEmpty()){if(this.isBOF())throw new d.AnterosDatasourceError("Inicio do Datasource encontrado.");if(this.isBOF())throw new d.AnterosDatasourceError("Fim do Datasource encontrado.");var e=this.data[this.currentRecno];"dsEdit"==this.getState()&&(e=this.currentRecord);return this._fieldByName(e,t)}}},{key:"_fieldByName",value:function(t,e){var r=d.AnterosObjectUtils.getNestedProperty(t,e);if(void 0!=r){var s=d.AnterosDateUtils.parseDateWithFormat(r,d.Anteros.dataSourceDatetimeFormat);return s instanceof Date?s:r}}},{key:"setFieldByName",value:function(t,e){if(!this.isEmpty()){if("dsBrowse"==this.getState())throw new d.AnterosDatasourceError("Registro não está sendo inserido ou editado.");var r=e;e instanceof Date&&(r=d.AnterosDateUtils.formatDate(e,d.Anteros.dataSourceDatetimeFormat)),d.AnterosObjectUtils.setNestedProperty(this.currentRecord,t,r),this.dispatchEvent(E.DATA_FIELD_CHANGED,null,t)}}},{key:"locate",value:function(t){if("dsBrowse"!=this.getState())throw new d.AnterosDatasourceError("Registro atual está sendo inserido ou editado.");if(this.isEmpty())return!1;var e=-1,r=this,s=-1;return this.data.forEach(function(i){s++;for(var o in t)r._fieldByName(i,o)==t[o]&&(e=s)}),e>=0&&this.gotoRecord(e),e>=0}},{key:"isEOF",value:function(){return this.currentRecno>this.totalRecords-1||this.isEmpty()}},{key:"isBOF",value:function(){return-1==this.currentRecno}},{key:"isFirst",value:function(){return 0==this.currentRecno}},{key:"isLast",value:function(){return this.currentRecno==this.getTotalRecords-1}},{key:"first",value:function(){if("dsBrowse"!=this.getState())throw new d.AnterosDatasourceError("Registro atual está sendo inserido ou editado.");this.getTotalRecords()>0?(this.currentRecno=0,this.currentRecord=this.data[this.currentRecno],this.dispatchEvent(E.AFTER_SCROLL)):(this.currentRecno=-1,this.currentRecord=null)}},{key:"last",value:function(){if("dsBrowse"!=this.getState())throw new d.AnterosDatasourceError("Registro atual está sendo inserido ou editado.");this.getTotalRecords()>0?(this.currentRecno=this.getTotalRecords()-1,this.currentRecord=this.data[this.currentRecno],this.dispatchEvent(E.AFTER_SCROLL)):(this.currentRecno=-1,this.currentRecord=null)}},{key:"next",value:function(){if("dsBrowse"!=this.getState())throw new d.AnterosDatasourceError("Registro atual está sendo inserido ou editado.");if(this.isEmpty())throw new d.AnterosDatasourceError("Não há registros. Impossível avançar um registro.");if(this.isEOF())throw new d.AnterosDatasourceError("Não é possível avançar pois você já está no final do DataSource.");this.currentRecno+1>this.getTotalRecords()-1?(this.currentRecno=this.currentRecno+1,this.currentRecord=null):(this.currentRecno=this.currentRecno+1,this.currentRecord=this.data[this.currentRecno],this.dispatchEvent(E.AFTER_SCROLL))}},{key:"prior",value:function(){if("dsBrowse"!=this.getState())throw new d.AnterosDatasourceError("Registro atual está sendo inserido ou editado.");if(this.isEmpty())throw new d.AnterosDatasourceError("Não há registros. Impossível voltar um registro.");if(this.isBOF())throw new d.AnterosDatasourceError("Não é possível retroceder pois você já está no inicio do DataSource.");this.currentRecno-1<0?(this.currentRecno=-1,this.currentRecord=null):(this.currentRecno=this.currentRecno-1,this.currentRecord=this.data[this.currentRecno],this.dispatchEvent(E.AFTER_SCROLL))}},{key:"previous",value:function(){this.prior()}},{key:"hasNext",value:function(){return!this.isEmpty()&&!this.isEOF()&&this.currentRecno+1<=this.getTotalRecords()-1}},{key:"hasPrior",value:function(){return!this.isEmpty()&&!this.isBOF()&&this.currentRecno-1>=0}},{key:"hasPrevious",value:function(){return this.hasPrior()}},{key:"_validateInsert",value:function(){if("dsEdit"==this.getState())throw new d.AnterosDatasourceError("Registro já está sendo editado.");if("dsInsert"==this.getState())throw new d.AnterosDatasourceError("Registro já está sendo inserido.")}},{key:"insert",value:function(){this._validateInsert(),this.dispatchEvent(E.BEFORE_INSERT),this.oldRecordInsert=this.getCurrentRecord(),this.oldRecnoInsert=this.getRecno(),this.totalRecords++,this.grandTotalRecords++;var t=this.getTotalRecords();this.data[t-1]={},this.currentRecord=this.data[t-1],this.currentRecno=t-1,this.dsState="dsInsert",this.dispatchEvent(E.AFTER_SCROLL),this.dispatchEvent(E.AFTER_INSERT)}},{key:"_validateDelete",value:function(){if(this.isEmpty())throw new d.AnterosDatasourceError("Não há registros para remover.");if(this.isBOF())throw new d.AnterosDatasourceError("Inicio do Datasource encontrado.");if(this.isBOF())throw new d.AnterosDatasourceError("Fim do Datasource encontrado.");if("dsEdit"==this.getState())throw new d.AnterosDatasourceError("Registro já está sendo editado.");if("dsInsert"==this.getState())throw new d.AnterosDatasourceError("Registro já está sendo inserido.")}},{key:"delete",value:function(t){this._validateDelete(),this.dispatchEvent(E.BEFORE_DELETE),this.data.splice(this.currentRecno,1),this.totalRecords--,this.grandTotalRecords--,0==this.data.length?this.currentRecord=void 0:this.currentRecord=this.data[this.currentRecno],this.dsState="dsBrowse",this.dispatchEvent(E.AFTER_SCROLL),this.dispatchEvent(E.AFTER_DELETE),t&&t()}},{key:"_validateEdit",value:function(){if(this.isEmpty())throw new d.AnterosDatasourceError("Não há registros para editar.");if(this.isBOF())throw new d.AnterosDatasourceError("Inicio do Datasource encontrado.");if(this.isBOF())throw new d.AnterosDatasourceError("Fim do Datasource encontrado.");if("dsEdit"==this.getState())throw new d.AnterosDatasourceError("Registro já está sendo editado.");if("dsInsert"==this.getState())throw new d.AnterosDatasourceError("Registro já está sendo inserido.")}},{key:"edit",value:function(){this._validateEdit(),this.dispatchEvent(E.BEFORE_EDIT),this.dsState="dsEdit",this.currentRecord=(0,l.cloneDeep)(this.currentRecord),this.dispatchEvent(E.AFTER_EDIT)}},{key:"_validatePost",value:function(){if("dsBrowse"==this.dsState)throw new d.AnterosDatasourceError("Registro não está sendo inserido ou editado.")}},{key:"post",value:function(t){this._validatePost(),this.dispatchEvent(E.BEFORE_POST),"dsEdit"==this.dsState&&(this.data[this.getRecno()]=this.currentRecord),this.dsState="dsBrowse",this.dispatchEvent(E.AFTER_POST),t&&t()}},{key:"_validateCancel",value:function(){if("dsBrowse"==this.dsState)throw new d.AnterosDatasourceError("Registro não está sendo inserido ou editado.")}},{key:"cancel",value:function(){this._validateCancel(),this.dispatchEvent(E.BEFORE_CANCEL),"dsInsert"==this.dsState?(this.data.splice(this.currentRecno,1),this.currentRecord=this.oldRecordInsert,this.currentRecno=this.oldRecnoInsert,this.totalRecords--,this.grandTotalRecords--,this.dsState="dsBrowse",this.dispatchEvent(E.AFTER_SCROLL)):this.currentRecord=this.data[this.currentRecno],this.dsState="dsBrowse",this.dispatchEvent(E.AFTER_CANCEL)}},{key:"disabledAllListeners",value:function(){this._enableListeners=!1}},{key:"enableAllListeners",value:function(){this._enableListeners=!0}},{key:"dispatchEvent",value:function(t,e,r){this._enableListeners&&this.listeners.forEach(function(s){s.event==t&&(r?s.fieldName.startsWith(r)&&s.dispatch(t,e,r):s.dispatch(t,e))})}},{key:"addEventListener",value:function(t,e,r){var s=this;d.AnterosUtils.isArray(t)?t.forEach(function(t){s.listeners.push({event:t,dispatch:e,fieldName:r})}):this.listeners.push({event:t,dispatch:e,fieldName:r})}},{key:"removeEventListener",value:function(t,e,r){var s=this;d.AnterosUtils.isArray(t)?t.forEach(function(t){s.removeEventListener(t,e)}):this.listeners=this.listeners.filter(function(s){return s.event!==t||s.dispatch!==e||s.fieldName!==r})}}]),t}(),v=function(t){function e(t){a(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.data=t,r.cloneOnEdit=!0,r}return o(e,t),h(e,[{key:"open",value:function(t,r){n(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"open",this).call(this),this.data=t,this.data||(this.data=[]),this.totalRecords=this.data.length,this.grandTotalRecords=this.data.length,this.dispatchEvent(E.AFTER_OPEN),this.first(),this.cloneOnEdit=void 0!=r&&r}},{key:"close",value:function(){n(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"close",this).call(this),this.data=[],this.totalRecords=this.data.length,this.grandTotalRecords=this.data.length,this.dispatchEvent(E.AFTER_CLOSE)}},{key:"edit",value:function(){this._validateEdit(),this.dispatchEvent(E.BEFORE_EDIT),this.dsState="dsEdit",this.cloneOnEdit&&(this.currentRecord=(0,l.cloneDeep)(this.currentRecord)),this.dispatchEvent(E.AFTER_EDIT)}},{key:"append",value:function(t){if("dsEdit"==this.getState())throw new d.AnterosDatasourceError("Registro já está sendo editado.");if("dsInsert"==this.getState())throw new d.AnterosDatasourceError("Registro já está sendo inserido.");this.data||(this.data=[]),this.data.push(t),this.totalRecords=this.data.length,this.grandTotalRecords=this.data.length,this.currentRecord=t,this.currentRecno=this.data.length-1,this.dispatchEvent(E.AFTER_POST),this.dispatchEvent(E.AFTER_SCROLL)}}]),e}(p),g=function(t){function e(t){a(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.ajaxConfig=t,r.ajaxPageConfigHandler=void 0,r.ajaxPostConfigHandler=void 0,r.ajaxDeleteConfigHandler=void 0,r.validatePostResponse=void 0,r.validateDeleteResponse=void 0,r.storePostResultToRecord=!0,r.setAjaxPageConfigHandler=r.setAjaxPageConfigHandler.bind(r),r.setAjaxPostConfigHandler=r.setAjaxPostConfigHandler.bind(r),r.setAjaxDeleteConfigHandler=r.setAjaxDeleteConfigHandler.bind(r),r.setStorePostResultToRecord=r.setStorePostResultToRecord.bind(r),r.setValidatePostResponse=r.setValidatePostResponse.bind(r),r.setValidateDeleteResponse=r.setValidateDeleteResponse.bind(r),r.executeAjax=r.executeAjax.bind(r),r.executed=!1,r}return o(e,t),h(e,[{key:"setValidatePostResponse",value:function(t){this.validatePostResponse=t}},{key:"setValidateDeleteResponse",value:function(t){this.validateDeleteResponse=t}},{key:"setStorePostResultToRecord",value:function(t){this.storePostResultToRecord=t}},{key:"setAjaxPageConfigHandler",value:function(t){this.ajaxPageConfigHandler=t}},{key:"setAjaxPostConfigHandler",value:function(t){this.ajaxPostConfigHandler=t}},{key:"setAjaxDeleteConfigHandler",value:function(t){this.ajaxDeleteConfigHandler=t}},{key:"open",value:function(t){if(n(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"open",this).call(this),t&&null!=t){this.executeAjax(t||this.ajaxConfig,E.AFTER_OPEN)}else this.dispatchEvent(E.AFTER_OPEN)}},{key:"post",value:function(t){if(!this.ajaxPostConfigHandler||!this.validatePostResponse){var e="Para salvar dados remotamente é necessário configurar 'setAjaxPostConfigHandler' e 'setValidatePostResponse' ";throw this.dispatchEvent(E.ON_ERROR,e),new d.AnterosDatasourceError(e)}var r=this;this._validatePost(),this.dispatchEvent(E.BEFORE_POST);var s=this.ajaxPostConfigHandler(this.currentRecord);(0,u.default)(s).then(function(e){if(r.validatePostResponse(e)){if("dsEdit"==r.dsState&&(r.data[r.getRecno()]=r.currentRecord),1==r.storePostResultToRecord){var s=d.AnterosJacksonParser.convertJsonToObject(e.data);r.data[r.getRecno()]=s,r.currentRecord=s}r.dsState="dsBrowse",r.dispatchEvent(E.AFTER_POST),t&&t()}}).catch(function(e){t&&t(e),r.dispatchEvent(E.ON_ERROR,e)})}},{key:"delete",value:function(t){if(!this.ajaxDeleteConfigHandler||!this.validateDeleteResponse){var e="Para remover dados remotamente é necessário configurar 'setAjaxDeleteConfigHandler' e 'setValidateDeleteResponse' ";throw this.dispatchEvent(E.ON_ERROR,e),new d.AnterosDatasourceError(e)}var r=this;this._validateDelete(),this.dispatchEvent(E.BEFORE_DELETE);var s=this.ajaxDeleteConfigHandler(this.currentRecord);(0,u.default)(s).then(function(e){r.validateDeleteResponse(e)&&(r.data.splice(r.currentRecno,1),0==r.data.length?r.currentRecord=void 0:r.currentRecord=r.data[r.currentRecno],r.totalRecords--,r.grandTotalRecords--,r.dsState="dsBrowse",r.dispatchEvent(E.AFTER_SCROLL),r.dispatchEvent(E.AFTER_DELETE)),t&&t()}).catch(function(e){t&&t(e),r.dispatchEvent(E.ON_ERROR,e)})}},{key:"goToPage",value:function(t){if(!this.ajaxPageConfigHandler){var e="Para buscar dados paginados remotamente é necessário configurar 'setAjaxPageConfigHandler'";throw this.dispatchEvent(E.ON_ERROR,e),new d.AnterosDatasourceError(e)}this.dispatchEvent(E.BEFORE_GOTO_PAGE);var r=this.ajaxPageConfigHandler(t);this.executeAjax(r,E.AFTER_GOTO_PAGE)}},{key:"executeAjax",value:function(t,e){var r=this;this.executed=!1,(0,u.default)(t||this.ajaxConfig).then(function(t){if(t.data.hasOwnProperty(r.totalPagesProperty)&&(r.totalPages=t.data[r.totalPagesProperty]),t.data.hasOwnProperty(r.currentPageProperty)&&(r.currentPage=t.data[r.currentPageProperty]),t.data.hasOwnProperty(r.sizeOfPageProperty)&&(r.sizeOfPage=t.data[r.sizeOfPageProperty]),t.data.hasOwnProperty(r.totalRecordsProperty)&&(r.totalRecords=t.data[r.totalRecordsProperty]),t.data.hasOwnProperty(r.grandTotalRecordsProperty)&&(r.grandTotalRecords=t.data[r.grandTotalRecordsProperty]),t.data.hasOwnProperty(r.contentProperty)){var s=d.AnterosJacksonParser.convertJsonToObject(t.data[r.contentProperty]);d.AnterosUtils.isArray(s)?r.data=s:(r.data=[],r.data.push(s))}else{var i=d.AnterosJacksonParser.convertJsonToObject(t.data);d.AnterosUtils.isArray(i)?r.data=i:(r.data=[],r.data.push(i)),r.totalRecords=r.data.length,r.grandTotalRecords=r.data.length}r.executed=!0,r.first(),r.dispatchEvent(e)}).catch(function(t){if(r.executed)throw new Error(t);r.dispatchEvent(E.ON_ERROR,t)})}},{key:"close",value:function(){n(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"close",this).call(this),this.data=[],this.dispatchEvent(E.AFTER_CLOSE)}}]),e}(p);e.AnterosLocalDatasource=v,e.AnterosRemoteDatasource=g},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dataSourceEvents=e.AnterosRemoteDatasource=e.AnterosLocalDatasource=e.AnterosDatasource=void 0;var s=r(0);e.AnterosDatasource=s.AnterosDatasource,e.AnterosLocalDatasource=s.AnterosLocalDatasource,e.AnterosRemoteDatasource=s.AnterosRemoteDatasource,e.dataSourceEvents=s.dataSourceEvents},function(t,e){t.exports=require("anteros-react-core")},function(t,e){t.exports=require("axios")},function(t,e){t.exports=require("lodash")},function(t,e){t.exports=require("react")}])});